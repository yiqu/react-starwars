import{a as o,b as t,j as e,A as m,R as C,C as E,g as h,D as I,E as T,H as P,J as S,K as w,L as M,r as f,F as _,M as k,N as F,O as D,P as j,l as A,m as H,G as u,T as b,Q as L}from"./index-bdb862c7.js";import{E as O}from"./ErrorPage-160291d2.js";import"./index-9ec87944.js";import{u as y}from"./useIsMobile-6fe3e631.js";import{a as W}from"./index-86476681.js";import{P as q}from"./CircleProgress-ece8a92a.js";const B="_detailcard_1ldpg_1",N={detailcard:B},z=["release_date","director","producer","characters","planets","species","starships","vehicles"];function R({movieDetail:i}){const{isMobile:n}=y();return o(t.Card,{raised:!1,className:n?"":`${N.detailcard}`,children:[e(t.CardMedia,{component:"img",alt:"poster",height:"400",image:`/assets/poster-img/${i.episode_id}.png`,title:"Film poster"}),o(t.CardContent,{children:[o(t.Stack,{direction:"column",children:[e(t.Typography,{sx:{fontFamily:"Poppins",fontWeight:"500"},children:i.title}),o(t.Typography,{sx:{fontWeight:"300"},children:["EP ",i.episode_id]})]}),e(t.Divider,{sx:{my:2}}),e(t.Stack,{direction:"column",sx:{fontSize:"12.5px",overflow:"auto"},children:e("table",{style:{borderSpacing:"0px 5px"},children:e("tbody",{children:z.map(r=>o("tr",{children:[e("td",{style:{width:"35%"},children:e(t.Typography,{variant:"subtitle2",children:m.startCase(r)})}),e("td",{children:m.isArray(i[r])?i[r].length:i[r]})]},r))})})})]}),e(t.CardActions,{})]})}function V({id:i,position:n="bottom"}){const[r,c]=C.useState(null),[p,g]=C.useState(null),d=()=>{c(null)},x=(s,l)=>{c(r?null:s),g(l)};return{popover:e(t.Popper,{id:i,open:!!r,anchorEl:r,placement:n,children:p}),handlePopoverClose:d,handlePopoverOpen:x}}var $=E();const G=h($);var J=I();const Q=h(J);var U=T();const X=h(U);var Y=P();const Z=h(Y);var K=S();const ee=h(K);var te=w();const re=h(te);var ie=M();const ne=h(ie),se=["gender","birth_year","height","mass","hair_color","skin_color","eye_color"];function oe({url:i,onCloseClick:n}){const[r,c]=f.useState(!0),[p,g]=f.useState(),[d,x]=f.useState();return f.useEffect(()=>{const a=new AbortController;return c(!0),W.get(`${i}`,{signal:a.signal}).then(s=>{x(s.data.result.properties)}).catch(s=>{g(s.message)}).finally(()=>{c(!1)}),()=>{a.abort()}},[i]),r?e(v,{props:{alignItems:"center"},children:e(q,{size:60})}):p?o(v,{children:["Error occurred: ",p]}):e(_,{children:d&&e(v,{children:o(t.Stack,{direction:"column",spacing:0,width:"100%",children:[e(t.Stack,{direction:"row",justifyContent:"center",alignItems:"center",sx:{bgcolor:a=>a.palette.mode==="light"?"primary.main":"#2b4052",color:a=>a.palette.mode==="light"?"#fff":null},p:2,children:e(t.Typography,{variant:"h5",children:d.name})}),e(k,{children:se.map(a=>o(F,{dense:!0,children:[e(D,{children:ae(a)}),e(j,{primary:m.startCase(a),secondary:m.upperFirst(d[a])})]},a))}),e(t.Divider,{}),e(t.Stack,{children:e(t.Button,{variant:"text",onClick:n,children:"Close"})})]})})})}const v=({props:i,children:n})=>{const{isMobile:r}=y();return e(t.Box,{children:e(t.Paper,{sx:{p:0,width:"100%",height:"100%",minHeight:"20rem",minWidth:r?"0rem":"20rem",display:"flex",justifyContent:"center",alignItems:"start",...i},children:n})})},ae=i=>({gender:e(Q,{}),birth_year:e(X,{}),height:e(G,{}),mass:e(Z,{}),hair_color:e(ee,{}),skin_color:e(re,{}),eye_color:e(ne,{})})[i];function le({columns:i,columnData:n,header:r}){const[c,p]=f.useState([]),{popover:g,handlePopoverClose:d,handlePopoverOpen:x}=V({id:"film-detail-popover"});y(),A.useDeepCompareEffect(()=>{p(ce(n))},[n]);const a=s=>l=>{x(l.currentTarget,e(oe,{url:s,onCloseClick:d}))};return o(t.Stack,{children:[e(t.Box,{sx:{width:"100%"},children:o(t.Paper,{sx:{width:"100%",mb:2},elevation:1,children:[r,e(t.TableContainer,{children:o(t.Table,{size:"medium",children:[e(t.TableHead,{children:e(t.TableRow,{children:i.map(s=>e(t.TableCell,{width:"50%",children:m.upperFirst(s)},s))})}),e(t.TableBody,{children:c.map(s=>e(t.TableRow,{sx:{"&:last-child td, &:last-child th":{border:0},"&:nth-of-type(odd)":{backgroundColor:l=>l.palette.action.hover}},children:Object.keys(c[0]).map(l=>e(t.TableCell,{component:"th",scope:"row",children:e(t.Box,{sx:{display:"flex"},children:e(t.Typography,{title:s[l],sx:{cursor:"pointer"},children:l==="id"?s[l]:e(t.Button,{variant:"outlined",size:"small",onClick:a(s.detail),children:"View"})})})},l))},s.detail))})]})})]})}),g]})}function ce(i=[]){return i.map(n=>{const r=n.split("/");return{id:r[r.length-1],detail:n}})}const de=["characters","planets","species","starships","vehicles"],fe=()=>{const{isMobile:i}=y(),n=H.useLoaderData();return n?e(u,{xs:12,container:!0,sx:{p:2},children:e(u,{xs:12,sm:8,xsOffset:0,smOffset:2,children:o(u,{xs:12,container:!0,justifyContent:"space-between",alignItems:"center",flexDirection:{xs:"column",sm:"row"},children:[e(u,{xs:12,sm:5,sx:{mb:i?2:0},children:e(t.Stack,{direction:"column",children:e(R,{movieDetail:n})})}),e(u,{xs:12,sm:7,children:o(t.Stack,{direction:"column",spacing:2,children:[e(b,{variant:"h4",sx:{fontWeight:500},children:n.title}),e(t.Divider,{sx:{my:2}}),e(t.Box,{children:e(b,{variant:"body1",children:n.opening_crawl})}),de.map(r=>e(le,{columns:["id","detail"],columnData:n[r],header:o(b,{sx:{display:"flex",justifyContent:"start",alignItems:"center",pt:2,pl:2},variant:"h5",component:"div",children:[e(L,{sx:{mr:1}}),e("div",{style:{fontFamily:"Poppins"},children:m.startCase(r)})]})},r))]})})]})})}):o(u,{xs:12,sm:8,smOffset:2,xsOffset:1,children:[" ",e(O,{reason:"Result is malformed",debug:"No properties"})," "]})};export{fe as default};
