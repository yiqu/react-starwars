import{h as I,g as w,u as S,R as e,a,T as s,m as h,I as _,_ as P,i as T,t as M,j as A,k as B,r as x,S as L,b as c,n as j,G as r,o as R,p as $}from"./index-6f160e43.js";import{P as H}from"./CircleProgress-c6639d1f.js";import{F as U}from"./FilterInput-87db11a2.js";import{C as q,a as Y,b as z,c as N,B as W}from"./index-071cd14f.js";import{H as G}from"./HourglassBottom-67d9f906.js";import{a as O,s as V,b as J,c as K,d as Q}from"./films.selectors-3c721b0d.js";import{D as X}from"./DateDisplay-6d1e7cdf.js";import{A as Z}from"./Toolbar-38014177.js";import{u as ee}from"./useIsMobile-6dae06e0.js";import{D as E}from"./general.model-1fceca1f.js";import{E as te}from"./ErrorPage-1875f54f.js";import{s as ae,a as re}from"./favorites.selectors-028a202c.js";import"./useDebounce-ab0edeff.js";var oe=I();const ne=w(oe);function se({film:t,uid:o,userId:y,allFavoritesLoading:f,favToggleLoading:k}){var C;const d=S(),m=()=>{var l,v;const{url:p}=t,b=p.split("/")[p.split("/").length-1],u=P(T,`swdb/:user/favorites${(l=t.favorite)!=null&&l.fireId?"/"+((v=t.favorite)==null?void 0:v.fireId):""}.json`,{user:y}),i={filmUrl:p,filmId:b,lastUpdated:new Date().getTime(),episodeId:t.episode_id,isCurrentFavorite:!0};let g;t.favorite?(i.isCurrentFavorite=!t.favorite.isCurrentFavorite,i.fireId=t.favorite.fireId,g=d(M({fav:i,url:u,favStatus:!t.favorite.isCurrentFavorite}))):g=d(A({fav:i,url:u,favStatus:!0})),g.then(F=>d(B({httpParams:{user:"yqu"}})))};return e.createElement(q,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between"},elevation:2},e.createElement("div",null,e.createElement(Y,{component:"img",alt:"poster",height:"440",image:`/assets/poster-img/${t.episode_id}.png`,sx:{backgroundColor:"#000",objectFit:"contain"}}),e.createElement(z,null,e.createElement(a.Stack,{direction:{lg:"column",xl:"row"},justifyContent:{xl:"space-between",lg:"flex-start"},marginBottom:{lg:"10px",xl:"0px"}},e.createElement(s,{gutterBottom:!0,variant:"h5",component:h.Link,to:`./${o}`,sx:{fontWeight:"500"}},t.title),e.createElement(s,{variant:"h5",color:"text.secondary",sx:{fontWeight:"300"}},"EP ",t.episode_id)),e.createElement(a.Stack,{spacing:1},e.createElement(a.Stack,{direction:"row",spacing:.5},e.createElement(s,{variant:"body1",color:"text.secondary"},"Released:"),e.createElement(s,{variant:"body1",color:"text.secondary"},e.createElement(X,{date:t.release_date,format:"MMM Do YYYY"}))),e.createElement(s,{variant:"body1",color:"text.secondary"},"Directed by: ",t.director),e.createElement(s,{variant:"body1",color:"text.secondary"},"Produced by: ",t.producer),e.createElement(s,{variant:"body1",color:"text.primary"},t.opening_crawl)))),e.createElement(N,{sx:{display:"flex",justifyContent:"space-between"}},e.createElement("div",null,e.createElement(W,{size:"small",component:h.Link,to:`./${o}`},"See More")),e.createElement("div",null,e.createElement(_,{"aria-label":"favorite",onClick:m,title:O(t.favorite),disabled:!!f},f?e.createElement(G,null):e.createElement(ne,{color:(C=t.favorite)!=null&&C.isCurrentFavorite?"error":"disabled"})))))}const ie="_loadingbackdrop_1tkxi_1",le="_spinner_1tkxi_1",ce={loadingbackdrop:ie,spinner:le};function de({isLoading:t,children:o}){return e.createElement(a.Box,{className:t?`${ce.loadingbackdrop}`:"",width:"100%"},o)}const me="yqu",De=()=>{const t=S(),{showSnackbar:o}=x.useContext(L),[y,f]=h.useSearchParams(),k=y.get("moviePageDisplayMode"),{isMobile:d}=ee(),[m,C]=x.useState(k),p=c(V),b=c(J),u=c(K),i=c(ae),g=c(re),l=c(Q);x.useEffect(()=>()=>{o("info",void 0)},[o]);const v=x.useCallback(n=>{t(j({title:n}))},[t]),F=()=>{const n={moviePageDisplayMode:D(m)};f(n)};return e.createElement(e.Fragment,null,e.createElement(Z,{toolbarProps:{position:"sticky",sx:{top:d?"56px":"64px"}}},e.createElement(r,{container:!0,xs:12,flexDirection:{xs:"row",sm:"row"},justifyContent:"space-between",alignItems:"center"},e.createElement(r,{xs:10,sm:4},e.createElement(a.Stack,{direction:"row",justifyContent:"start",alignItems:"center"},e.createElement(r,{container:!0,xs:12},e.createElement(r,{xs:8},e.createElement(U,{filterChange:v})),e.createElement(r,{xs:2,sx:{display:"flex"},justifyContent:"center",alignItems:"center"},b&&e.createElement(H,{size:20}))))),e.createElement(r,{xs:2,sm:8},e.createElement(a.Stack,{direction:"row",justifyContent:"flex-end",alignItems:"center"},e.createElement(a.Tooltip,{title:`Switch to ${D(m)}`},e.createElement(a.IconButton,{onClick:F},m===E.CARD?e.createElement(R,null):e.createElement($,null))))))),e.createElement(de,{isLoading:p},u?e.createElement(te,{reason:"Failed loading all films.",debug:u}):e.createElement(a.Stack,{direction:"column",p:2,width:"100%"},e.createElement(r,{container:!0,disableEqualOverflow:!0,rowSpacing:4},l==null?void 0:l.map(n=>e.createElement(r,{key:n.properties.episode_id,xs:12,sm:4,smOffset:4},e.createElement(se,{userId:me,film:n.properties,uid:n.uid,allFavoritesLoading:i,favToggleLoading:g})))))))},D=t=>t?t===E.CARD?E.TABLE:E.CARD:E.CARD;export{De as default};
