"use strict";(self.webpackChunkstarwars=self.webpackChunkstarwars||[]).push([[978],{8985:function(e,n,t){var r=t(1413),i=t(885),o=t(799),a=t(2791),s=t(6884),l=t(1070),c=t.n(l),u=t(5885),d=t(773);n.Z=function(e){var n=e.params,t=void 0===n?{refetch:0}:n,l=(0,a.useState)(),f=(0,i.Z)(l,2),v=f[0],p=f[1],x=(0,a.useRef)(new AbortController);(0,s.Z)((function(){var e=c()(d.H,"/films",(0,r.Z)({},t));x.current.abort(),x.current=new AbortController,p(e)}),[t]);var h=(0,o.ZP)((function(){return v||null}),(function(e){return(0,u.$)(e,x.current)}),{revalidateOnFocus:!1,revalidateIfStale:!0,keepPreviousData:!0,shouldRetryOnError:!0}),m=h.data,Z=h.isValidating,j=h.error,g=h.isLoading;return{allFilms:null===m||void 0===m?void 0:m.result,allFilmsLoading:g,allFilmsValidating:Z,allFilmsError:j}}},2978:function(e,n,t){t.r(n),t.d(n,{default:function(){return W}});var r=t(885),i=t(2791),o=t(4162),a=t(5814),s=t(3811),l=t(6227),c=t(1413),u=t(799),d=t(6884),f=t(1070),v=t.n(f),p=t(5885),x=t(773),h=function(e){var n=e.userId,t=e.params,o=void 0===t?{}:t,a=(0,i.useState)(),s=(0,r.Z)(a,2),l=s[0],f=s[1],h=(0,i.useState)({}),m=(0,r.Z)(h,2),Z=m[0],j=m[1];(0,d.Z)((function(){var e=v()(x.K,"/swdb/:user/favorites.json",(0,c.Z)({user:"yqu"},o));f(e)}),[n,o]);var g=(0,u.ZP)((function(){return l||null}),(function(e){return(0,p.k)(e)}),{revalidateIfStale:!0,revalidateOnFocus:!1,revalidateOnReconnect:!1}),y=g.data,b=(g.isValidating,g.error),C=g.isLoading;return(0,i.useEffect)((function(){var e={};y&&(Object.keys(null!==y&&void 0!==y?y:{}).forEach((function(n){e[y[n].episodeId]=(0,c.Z)({fireId:n},y[n])})),j(e))}),[y]),{data:Z,loading:C,error:b}},m=t(8985),Z=t(7150),j=t(7289),g=t(8928),y=t(6875),b=t(5194),C=t(199),w=t(7205),F=t(4565),E=t(1087),k=t(7237),I=t(6976),S=t(2426),L=t.n(S),A=t(2546),D=function(e){var n="",t=null!==e&&void 0!==e&&e.lastUpdated?L()(null===e||void 0===e?void 0:e.lastUpdated).fromNow():"";return n=null!==e&&void 0!==e&&e.isCurrentFavorite?"Remove from favorites":"Add to favorites",null!==e&&void 0!==e&&e.lastUpdated&&(n=n+". "+(e.isCurrentFavorite?"Favorited ":"Unfavorited ")+t),n},R=t(1155),P=t(2795),T=t(184);function _(e){var n,t=e.film,a=e.uid,l=e.userId,c=e.allFavoritesLoading,u=e.reloadMovies,d=(0,i.useState)(!1),f=(0,r.Z)(d,2),p=f[0],h=f[1],m=(0,i.useState)(!1),Z=(0,r.Z)(m,2),j=Z[0],S=Z[1];(0,i.useEffect)((function(){c||S(!1)}),[c]);return(0,T.jsxs)(g.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between"},elevation:2,children:[(0,T.jsxs)("div",{children:[(0,T.jsx)(C.Z,{component:"img",alt:"poster",height:"440",image:"".concat("","/assets/poster-img/").concat(t.episode_id,".png"),sx:{backgroundColor:"#000",objectFit:"contain"}}),(0,T.jsxs)(b.Z,{children:[(0,T.jsxs)(o.Z,{direction:{lg:"column",xl:"row"},justifyContent:{xl:"space-between",lg:"flex-start"},marginBottom:{lg:"10px",xl:"0px"},children:[(0,T.jsx)(F.Z,{gutterBottom:!0,variant:"h5",component:E.rU,to:"./".concat(a),sx:{fontFamily:"Poppins",fontWeight:"500"},children:t.title}),(0,T.jsxs)(F.Z,{variant:"h5",color:"text.secondary",sx:{fontWeight:"300"},children:["EP ",t.episode_id]})]}),(0,T.jsxs)(o.Z,{spacing:1,children:[(0,T.jsxs)(F.Z,{variant:"body2",color:"text.secondary",children:["Released: ",(0,T.jsx)(R.Z,{date:t.release_date,format:"MMM Do YYYY"})]}),(0,T.jsxs)(F.Z,{variant:"body2",color:"text.secondary",children:["Directed by: ",t.director]}),(0,T.jsxs)(F.Z,{variant:"body2",color:"text.secondary",children:["Produced by: ",t.producer]}),(0,T.jsx)(F.Z,{variant:"body2",color:"text.primary",children:t.opening_crawl})]})]})]}),(0,T.jsxs)(y.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,T.jsx)("div",{children:(0,T.jsx)(w.Z,{size:"small",component:E.rU,to:"./".concat(a),children:"See More"})}),(0,T.jsx)("div",{children:(0,T.jsx)(s.Z,{"aria-label":"favorite",onClick:function(){var e,n,r=t.url,i=r.split("/")[r.split("/").length-1],o=v()(x.K,"swdb/:user/favorites".concat(null!==(e=t.favorite)&&void 0!==e&&e.fireId?"/"+(null===(n=t.favorite)||void 0===n?void 0:n.fireId):"",".json"),{user:l}),a={filmUrl:r,filmId:i,lastUpdated:(new Date).getTime(),episodeId:t.episode_id,isCurrentFavorite:!0};h(!0),S(!0),t.favorite?(a.isCurrentFavorite=!t.favorite.isCurrentFavorite,a.fireId=t.favorite.fireId,(0,P.R3)({url:o,body:a,onSuccess:function(e){u()},onFailure:function(e){},onFinally:function(){h(!1)}})):(0,P.e$)({url:o,body:a,onSuccess:function(e){u()},onFailure:function(e){},onFinally:function(){h(!1)}})},title:D(t.favorite),disabled:!(!p&&!j),children:p||j?(0,T.jsx)(I.Z,{}):(0,T.jsx)(k.Z,{color:null!==(n=t.favorite)&&void 0!==n&&n.isCurrentFavorite?"error":"disabled"})})})]})]})}var M=t(3808),N=t(4596),U=t(1372),O=t(9841),B=t(824),K=t(6015),V="LoadingBackdrop_loadingbackdrop__fzQLF";var z,Y=function(e){var n=e.isLoading,t=e.children;return(0,T.jsx)(K.Z,{className:n?"".concat(V):"",width:"100%",children:t})},H=t(3607),q=t(758);!function(e){e.ERR_CANCELED="ERR_CANCELED"}(z||(z={}));var $=t(1917),G=t(4317),W=function(){var e=(0,i.useContext)(H.Z).showSnackbar,n=(0,E.lr)(),t=(0,r.Z)(n,2),c=t[0],u=t[1],f=c.get("moviePageDisplayMode"),v=(0,N.Z)().isMobile,p=(0,i.useState)(f),x=(0,r.Z)(p,2),g=x[0],y=(x[1],(0,i.useState)(0)),b=(0,r.Z)(y,2),C=b[0],w=b[1],F=(0,i.useState)({}),k=(0,r.Z)(F,2),I=k[0],S=k[1],L=(0,i.useState)([]),D=(0,r.Z)(L,2),R=(D[0],D[1]),P=h({userId:"yqu",params:{fetchTime:C}}),K=P.data,V=(P.error,P.loading),W=(0,m.Z)({params:I}),J=W.allFilms,X=W.allFilmsError,ee=W.allFilmsLoading,ne=W.allFilmsValidating,te=(0,G.C)($.td);(0,d.Z)((function(){R(function(e,n){return(0,A.ZP)(null!==e&&void 0!==e?e:[],(function(e){e.sort((function(e,n){return e.properties.episode_id>n.properties.episode_id?1:-1})),e.forEach((function(e){e.properties.favorite=n[e.properties.episode_id]}))}))}(J,K))}),[J,K]),(0,i.useEffect)((function(){X&&X.code!==z.ERR_CANCELED&&e("error",X)}),[X,e]),(0,i.useEffect)((function(){return function(){e("info",void 0)}}),[e]);var re=function(){w((new Date).getTime())},ie=(0,i.useCallback)((function(e){S(e?{title:e}:{})}),[]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(M.Z,{toolbarProps:{position:"sticky",sx:{top:v?"56px":"64px"}},children:(0,T.jsxs)(l.Z,{container:!0,xs:12,flexDirection:{xs:"row",sm:"row"},justifyContent:"space-between",alignItems:"center",children:[(0,T.jsx)(l.Z,{xs:10,sm:4,children:(0,T.jsx)(o.Z,{direction:"row",justifyContent:"start",alignItems:"center",children:(0,T.jsxs)(l.Z,{container:!0,xs:12,children:[(0,T.jsx)(l.Z,{xs:8,children:(0,T.jsx)(j.Z,{filterChange:ie})}),(0,T.jsx)(l.Z,{xs:2,sx:{display:"flex"},justifyContent:"center",alignItems:"center",children:ne&&(0,T.jsx)(Z.Z,{size:20})})]})})}),(0,T.jsx)(l.Z,{xs:2,sm:8,children:(0,T.jsx)(o.Z,{direction:"row",justifyContent:"flex-end",alignItems:"center",children:(0,T.jsx)(a.Z,{title:"Switch to ".concat(Q(g)),children:(0,T.jsx)(s.Z,{onClick:function(){var e={moviePageDisplayMode:Q(g)};u(e)},children:g===U.K.CARD?(0,T.jsx)(O.Z,{}):(0,T.jsx)(B.Z,{})})})})})]})}),(0,T.jsx)(Y,{isLoading:ee,children:X?(0,T.jsx)(q.Z,{reason:"Failed loading all films.",debug:X}):(0,T.jsx)(o.Z,{direction:"column",p:2,width:"100%",children:(0,T.jsx)(l.Z,{container:!0,disableEqualOverflow:!0,rowSpacing:4,children:null===te||void 0===te?void 0:te.map((function(e){return(0,T.jsx)(l.Z,{xs:12,sm:4,smOffset:4,children:(0,T.jsx)(_,{userId:"yqu",reloadMovies:re,film:e.properties,uid:e.uid,allFavoritesLoading:V})},e.properties.episode_id)}))})})})]})},Q=function(e){return e&&e===U.K.CARD?U.K.TABLE:U.K.CARD}},1917:function(e,n,t){t.d(n,{e:function(){return s},td:function(){return a}});var r=t(9422),i=function(e){return e.allFilms},o=r.VL.getSelectors((function(e){return e.allFilms})),a=o.selectAll,s=(o.selectById,o.selectEntities,o.selectIds,o.selectTotal,function(e){return i(e).apiParams})},1155:function(e,n,t){var r=t(5814),i=t(6431),o=t.n(i),a=t(2426),s=t.n(a),l=t(184);n.Z=function(e){var n=e.date,t=void 0===n?0:n,i=e.fromNow,a=void 0===i||i,c=e.format,u=void 0===c?"MM/DD/YY HH:mm":c;return(0,l.jsx)(r.Z,{title:t?s()(t).format(u):"No date found",children:(0,l.jsx)("span",{children:t?(0,l.jsx)(o(),{date:t,fromNow:a}):(0,l.jsx)(l.Fragment,{children:"N/A"})})})}},5885:function(e,n,t){t.d(n,{k:function(){return l},$:function(){return c}});var r=t(4165),i=t(5861),o=t(4569),a=t.n(o);function s(e){return new Promise((function(n,t){setTimeout((function(){n()}),e)}))}var l=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i,o=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=o.length>1&&void 0!==o[1]?o[1]:0)){e.next=4;break}return e.next=4,s(t);case 4:return e.prev=4,e.next=7,a().get(n,{headers:{"Content-Type":"application/json"},responseType:"json"});case 7:if(200!==(i=e.sent).status){e.next=10;break}return e.abrupt("return",i.data);case 10:return e.abrupt("return",Promise.reject(i));case 13:throw e.prev=13,e.t0=e.catch(4),console.error("App fetcher GET error:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(n){return e.apply(this,arguments)}}(),c=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,o,l=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=l.length>2&&void 0!==l[2]?l[2]:0)){e.next=4;break}return e.next=4,s(i);case 4:return e.prev=4,e.next=7,a().get(n,{headers:{"Content-Type":"application/json"},responseType:"json",signal:t.signal});case 7:if(200!==(o=e.sent).status){e.next=10;break}return e.abrupt("return",o.data);case 10:return e.abrupt("return",Promise.reject(o));case 13:throw e.prev=13,e.t0=e.catch(4),"ERR_CANCELED"!==e.t0.code&&console.error("App fetcher GET error:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(n,t){return e.apply(this,arguments)}}()},1372:function(e,n,t){var r;t.d(n,{K:function(){return r}}),function(e){e.TABLE="table",e.CARD="card"}(r||(r={}))},2795:function(e,n,t){t.d(n,{R3:function(){return a},e$:function(){return o}});var r=t(4569),i=t.n(r),o=function(e){var n=e.url,t=e.body,r=e.onSuccess,o=e.onFailure,a=e.onFinally;e.abortController;i().post(n,t).then((function(e){r&&r(e.data)})).catch((function(e){console.log("App error POST: ",e),o&&o(e)})).finally((function(){a&&a()}))},a=function(e){var n=e.url,t=e.body,r=e.onSuccess,o=e.onFailure,a=e.onFinally;e.abortController;i().put(n,t).then((function(e){r&&r(e.data)})).catch((function(e){console.log("App error PUT: ",e),o&&o(e)})).finally((function(){a&&a()}))}},4317:function(e,n,t){t.d(n,{C:function(){return o},T:function(){return i}});var r=t(9434),i=r.I0,o=r.v9},7237:function(e,n,t){var r=t(4836);n.Z=void 0;var i=r(t(5649)),o=t(184),a=(0,i.default)((0,o.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}),"Favorite");n.Z=a},6976:function(e,n,t){var r=t(4836);n.Z=void 0;var i=r(t(5649)),o=t(184),a=(0,i.default)((0,o.jsx)("path",{d:"m18 22-.01-6L14 12l3.99-4.01L18 2H6v6l4 4-4 3.99V22h12zM8 7.5V4h8v3.5l-4 4-4-4z"}),"HourglassBottom");n.Z=a}}]);
//# sourceMappingURL=978.a2db1071.chunk.js.map