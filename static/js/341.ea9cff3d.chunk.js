(self.webpackChunkstarwars=self.webpackChunkstarwars||[]).push([[341],{1482:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return me}});var r,i=t(885),o=t(2791),a=t(4162),s=t(5814),c=t(3811),l=t(6227),u=t(1413),d=t(799),f=t(6884),v=t(1070),p=t.n(v),h=t(1582),x=t(773),m=function(e){var n=e.userId,t=e.params,r=void 0===t?{}:t,a=(0,o.useState)(),s=(0,i.Z)(a,2),c=s[0],l=s[1],v=(0,o.useState)({}),m=(0,i.Z)(v,2),Z=m[0],j=m[1];(0,f.Z)((function(){var e=p()(x.K,"/swdb/:user/favorites.json",(0,u.Z)({user:"yqu"},r));l(e)}),[n,r]);var g=(0,d.ZP)((function(){return c||null}),(function(e){return(0,h.k)(e)}),{revalidateIfStale:!0,revalidateOnFocus:!1,revalidateOnReconnect:!1}),b=g.data,y=(g.isValidating,g.error),C=g.isLoading;return(0,o.useEffect)((function(){var e={};b&&(Object.keys(null!==b&&void 0!==b?b:{}).forEach((function(n){e[b[n].episodeId]=(0,u.Z)({fireId:n},b[n])})),j(e))}),[b]),{data:Z,loading:C,error:y}},Z=t(3607);!function(e){e.ERR_CANCELED="ERR_CANCELED"}(r||(r={}));var j=function(e){var n=e.params,t=void 0===n?{refetch:0}:n,a=(0,o.useState)(),s=(0,i.Z)(a,2),c=s[0],l=s[1],v=(0,o.useState)(),m=(0,i.Z)(v,2),j=m[0],g=m[1],b=(0,o.useRef)(new AbortController),y=(0,o.useContext)(Z.Z).showSnackbar;(0,f.Z)((function(){var e=p()(x.H,"/films",(0,u.Z)({},t));b.current.abort(),b.current=new AbortController,l(e)}),[t]);var C=(0,d.ZP)((function(){return c||null}),(function(e){return(0,h.$)(e,b.current)}),{revalidateOnFocus:!1,revalidateIfStale:!0,keepPreviousData:!0,shouldRetryOnError:!0}),w=C.data,E=C.isValidating,S=C.error,F=C.isLoading;return(0,o.useEffect)((function(){S&&S.code!==r.ERR_CANCELED&&(y("error",S),g(S))}),[S,y]),{allFilms:null===w||void 0===w?void 0:w.result,allFilmsLoading:F,allFilmsValidating:E,allFilmsError:j}},g=t(5290),b=t(9911),y=t(4942),C=t(3366),w=t(7462),E=t(8182),S=t(4419),F=t(9853),k=t(4565),P=t(1211),A=t(529),I=t(277),L=t(5878),R=t(1217);function D(e){return(0,R.Z)("MuiInputAdornment",e)}var M,T=(0,L.Z)("MuiInputAdornment",["root","filled","standard","outlined","positionStart","positionEnd","disablePointerEvents","hiddenLabel","sizeSmall"]),_=t(5513),z=t(184),N=["children","className","component","disablePointerEvents","disableTypography","position","variant"],O=(0,I.ZP)("div",{name:"MuiInputAdornment",slot:"Root",overridesResolver:function(e,n){var t=e.ownerState;return[n.root,n["position".concat((0,F.Z)(t.position))],!0===t.disablePointerEvents&&n.disablePointerEvents,n[t.variant]]}})((function(e){var n=e.theme,t=e.ownerState;return(0,w.Z)({display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap",color:(n.vars||n).palette.action.active},"filled"===t.variant&&(0,y.Z)({},"&.".concat(T.positionStart,"&:not(.").concat(T.hiddenLabel,")"),{marginTop:16}),"start"===t.position&&{marginRight:8},"end"===t.position&&{marginLeft:8},!0===t.disablePointerEvents&&{pointerEvents:"none"})})),U=o.forwardRef((function(e,n){var t=(0,_.Z)({props:e,name:"MuiInputAdornment"}),r=t.children,i=t.className,a=t.component,s=void 0===a?"div":a,c=t.disablePointerEvents,l=void 0!==c&&c,u=t.disableTypography,d=void 0!==u&&u,f=t.position,v=t.variant,p=(0,C.Z)(t,N),h=(0,A.Z)()||{},x=v;v&&h.variant,h&&!x&&(x=h.variant);var m=(0,w.Z)({},t,{hiddenLabel:h.hiddenLabel,size:h.size,disablePointerEvents:l,position:f,variant:x}),Z=function(e){var n=e.classes,t=e.disablePointerEvents,r=e.hiddenLabel,i=e.position,o=e.size,a=e.variant,s={root:["root",t&&"disablePointerEvents",i&&"position".concat((0,F.Z)(i)),a,r&&"hiddenLabel",o&&"size".concat((0,F.Z)(o))]};return(0,S.Z)(s,D,n)}(m);return(0,z.jsx)(P.Z.Provider,{value:null,children:(0,z.jsx)(O,(0,w.Z)({as:s,ownerState:m,className:(0,E.Z)(Z.root,i),ref:n},p,{children:"string"!==typeof r||d?(0,z.jsxs)(o.Fragment,{children:["start"===f?M||(M=(0,z.jsx)("span",{className:"notranslate",children:"\u200b"})):null,r]}):(0,z.jsx)(k.Z,{color:"text.secondary",children:r})}))})})),K=t(1245),B=(0,K.Z)((0,z.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close"),H=(0,K.Z)((0,z.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),"Search"),Y=t(763);function V(e){var n=e.filterChange,t=(0,o.useState)(""),r=(0,i.Z)(t,2),a=r[0],s=r[1],l=function(e,n){var t=(0,o.useState)(e),r=(0,i.Z)(t,2),a=r[0],s=r[1];return(0,o.useEffect)((function(){var t=setTimeout((function(){s(e)}),n);return function(){clearTimeout(t)}}),[e,n]),a}(a,600);return(0,o.useEffect)((function(){n(l)}),[n,l]),(0,z.jsx)(b.Z,{name:"movieName",type:"text",fullWidth:!0,value:a,onChange:function(e){return s(e.target.value)},placeholder:"Filter by name",variant:"standard",InputProps:{endAdornment:(0,z.jsx)(U,{position:"end",children:!(0,Y.isEmpty)(a)&&(0,z.jsx)(c.Z,{onClick:function(){return s("")},size:"small",children:(0,z.jsx)(B,{})})}),startAdornment:(0,z.jsx)(U,{position:"start",children:(0,z.jsx)(H,{})})}})}var q=t(8928),W=t(6875),$=t(5194),G=t(199),J=t(7205),Q=t(1087),X=t(7237),ee=t(6976),ne=t(2426),te=t.n(ne),re=t(2546),ie=function(e){var n="",t=null!==e&&void 0!==e&&e.lastUpdated?te()(null===e||void 0===e?void 0:e.lastUpdated).fromNow():"";return n=null!==e&&void 0!==e&&e.isCurrentFavorite?"Remove from favorites":"Add to favorites",null!==e&&void 0!==e&&e.lastUpdated&&(n=n+". "+(e.isCurrentFavorite?"Favorited ":"Unfavorited ")+t),n},oe=t(1155),ae=t(2795);function se(e){var n,t=e.film,r=e.uid,s=e.userId,l=e.reloadMovies,u=(0,o.useState)(!1),d=(0,i.Z)(u,2),f=d[0],v=d[1];return(0,z.jsxs)(q.Z,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between"},elevation:4,children:[(0,z.jsxs)("div",{children:[(0,z.jsx)(G.Z,{component:"img",alt:"poster",height:"440",image:"".concat("","/assets/poster-img/").concat(t.episode_id,".png"),sx:{backgroundColor:"#000",objectFit:"contain"}}),(0,z.jsxs)($.Z,{children:[(0,z.jsxs)(a.Z,{direction:{lg:"column",xl:"row"},justifyContent:{xl:"space-between",lg:"flex-start"},marginBottom:{lg:"10px",xl:"0px"},children:[(0,z.jsx)(k.Z,{gutterBottom:!0,variant:"h5",component:Q.rU,to:"./".concat(r),sx:{fontFamily:"Poppins",fontWeight:"500"},children:t.title}),(0,z.jsxs)(k.Z,{variant:"h5",color:"text.secondary",sx:{fontWeight:"300"},children:["EP ",t.episode_id]})]}),(0,z.jsxs)(a.Z,{spacing:1,children:[(0,z.jsxs)(k.Z,{variant:"body2",color:"text.secondary",children:["Released: ",(0,z.jsx)(oe.Z,{date:t.release_date,format:"MMM Do YYYY"})]}),(0,z.jsxs)(k.Z,{variant:"body2",color:"text.secondary",children:["Directed by: ",t.director]}),(0,z.jsxs)(k.Z,{variant:"body2",color:"text.secondary",children:["Produced by: ",t.producer]}),(0,z.jsx)(k.Z,{variant:"body2",color:"text.primary",children:t.opening_crawl})]})]})]}),(0,z.jsxs)(W.Z,{sx:{display:"flex",justifyContent:"space-between"},children:[(0,z.jsx)("div",{children:(0,z.jsx)(J.Z,{size:"small",component:Q.rU,to:"./".concat(r),children:"See More"})}),(0,z.jsx)("div",{children:(0,z.jsx)(c.Z,{"aria-label":"favorite",onClick:function(){var e,n,r=t.url,i=r.split("/")[r.split("/").length-1],o=p()(x.K,"swdb/:user/favorites".concat(null!==(e=t.favorite)&&void 0!==e&&e.fireId?"/"+(null===(n=t.favorite)||void 0===n?void 0:n.fireId):"",".json"),{user:s}),a={filmUrl:r,filmId:i,lastUpdated:(new Date).getTime(),episodeId:t.episode_id,isCurrentFavorite:!0};v(!0),t.favorite?(a.isCurrentFavorite=!t.favorite.isCurrentFavorite,a.fireId=t.favorite.fireId,(0,ae.R3)({url:o,body:a,onSuccess:function(e){l()},onFailure:function(e){},onFinally:function(){v(!1)}})):(0,ae.e$)({url:o,body:a,onSuccess:function(e){l()},onFailure:function(e){},onFinally:function(){v(!1)}})},title:ie(t.favorite),disabled:!!f,children:f?(0,z.jsx)(ee.Z,{}):(0,z.jsx)(X.Z,{color:null!==(n=t.favorite)&&void 0!==n&&n.isCurrentFavorite?"error":"disabled"})})})]})]})}var ce=t(3808),le=t(4596),ue=t(1372),de=t(9841),fe=t(824),ve=t(6015),pe="LoadingBackdrop_loadingbackdrop__fzQLF";var he=function(e){var n=e.isLoading,t=e.children;return(0,z.jsx)(ve.Z,{className:n?"".concat(pe):"",width:"100%",children:t})};function xe(e){var n=e.reason,t=e.debug;return(0,z.jsx)(ve.Z,{marginY:5,children:(0,z.jsxs)(a.Z,{direction:"column",spacing:5,justifyContent:"center",alignItems:"center",children:[(0,z.jsx)(k.Z,{variant:"h5",sx:{textTransform:"uppercase"},children:"An error has occurred!"}),(0,z.jsxs)(a.Z,{direction:"column",spacing:1,justifyContent:"center",alignItems:"center",children:[(0,z.jsx)(k.Z,{variant:"body1",fontWeight:700,children:"REASON"}),(0,z.jsx)(k.Z,{variant:"body2",children:n})]}),(0,z.jsxs)(a.Z,{direction:"column",spacing:1,justifyContent:"center",alignItems:"center",children:[(0,z.jsx)(k.Z,{variant:"body1",fontWeight:700,children:"DEBUG"}),(0,z.jsx)(k.Z,{variant:"body2",component:"div",children:(0,z.jsx)("pre",{children:(0,z.jsx)("code",{style:{display:"flex",textAlign:"center"},children:JSON.stringify(t)})})})]})]})})}var me=function(){var e=(0,o.useContext)(Z.Z).showSnackbar,n=(0,Q.lr)(),t=(0,i.Z)(n,2),r=t[0],u=t[1],d=r.get("moviePageDisplayMode"),v=(0,le.Z)().isMobile,p=(0,o.useState)(d),h=(0,i.Z)(p,2),x=h[0],b=(h[1],(0,o.useState)(0)),y=(0,i.Z)(b,2),C=y[0],w=y[1],E=(0,o.useState)({}),S=(0,i.Z)(E,2),F=S[0],k=S[1],P=(0,o.useState)([]),A=(0,i.Z)(P,2),I=A[0],L=A[1],R=m({userId:"yqu",params:{fetchTime:C}}),D=R.data,M=(R.error,R.loading,j({params:F})),T=M.allFilms,_=M.allFilmsError,N=M.allFilmsLoading,O=M.allFilmsValidating;(0,f.Z)((function(){L(function(e,n){return(0,re.ZP)(null!==e&&void 0!==e?e:[],(function(e){e.sort((function(e,n){return e.properties.episode_id>n.properties.episode_id?1:-1})),e.forEach((function(e){e.properties.favorite=n[e.properties.episode_id]}))}))}(T,D))}),[T,D]),(0,o.useEffect)((function(){return function(){e("info",void 0)}}),[e]);var U=function(){w((new Date).getTime())},K=(0,o.useCallback)((function(e){k(e?{title:e}:{})}),[]);return(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(ce.Z,{toolbarProps:{position:"sticky",sx:{top:v?"56px":"64px"}},children:(0,z.jsxs)(l.Z,{container:!0,xs:12,flexDirection:{xs:"row",sm:"row"},justifyContent:"space-between",alignItems:"center",children:[(0,z.jsx)(l.Z,{xs:10,sm:4,children:(0,z.jsx)(a.Z,{direction:"row",justifyContent:"start",alignItems:"center",children:(0,z.jsxs)(l.Z,{container:!0,xs:12,children:[(0,z.jsx)(l.Z,{xs:8,children:(0,z.jsx)(V,{filterChange:K})}),(0,z.jsx)(l.Z,{xs:2,sx:{display:"flex"},justifyContent:"center",alignItems:"center",children:O&&(0,z.jsx)(g.Z,{size:20})})]})})}),(0,z.jsx)(l.Z,{xs:2,sm:8,children:(0,z.jsx)(a.Z,{direction:"row",justifyContent:"flex-end",alignItems:"center",children:(0,z.jsx)(s.Z,{title:"Switch to ".concat(Ze(x)),children:(0,z.jsx)(c.Z,{onClick:function(){var e={moviePageDisplayMode:Ze(x)};u(e)},children:x===ue.K.CARD?(0,z.jsx)(de.Z,{}):(0,z.jsx)(fe.Z,{})})})})})]})}),(0,z.jsx)(he,{isLoading:N,children:_?(0,z.jsx)(xe,{reason:"Failed loading all films.",debug:_}):(0,z.jsx)(a.Z,{direction:"column",p:2,width:"100%",children:(0,z.jsx)(l.Z,{container:!0,disableEqualOverflow:!0,rowSpacing:4,children:null===I||void 0===I?void 0:I.map((function(e){return(0,z.jsx)(l.Z,{xs:12,sm:4,smOffset:4,children:(0,z.jsx)(se,{userId:"yqu",reloadMovies:U,film:e.properties,uid:e.uid})},e.properties.episode_id)}))})})})]})},Ze=function(e){return e&&e===ue.K.CARD?ue.K.TABLE:ue.K.CARD}},773:function(e,n,t){"use strict";t.d(n,{H:function(){return i},K:function(){return r}});var r="https://kq-1-1a499.firebaseio.com/",i="https://swapi.tech/api/"},1155:function(e,n,t){"use strict";var r=t(5814),i=t(6431),o=t.n(i),a=t(2426),s=t.n(a),c=t(184);n.Z=function(e){var n=e.date,t=void 0===n?0:n,i=e.fromNow,a=void 0===i||i,l=e.format,u=void 0===l?"MM/DD/YY HH:mm":l;return(0,c.jsx)(r.Z,{title:t?s()(t).format(u):"No date found",children:(0,c.jsx)("span",{children:t?(0,c.jsx)(o(),{date:t,fromNow:a}):(0,c.jsx)(c.Fragment,{children:"N/A"})})})}},5290:function(e,n,t){"use strict";t.d(n,{Z:function(){return a}});t(2791);var r=t(4162),i=t(6580),o=t(184);function a(e){var n=e.size,t=void 0===n?40:n,a=e.color,s=void 0===a?"grey.500":a;return(0,o.jsx)(r.Z,{sx:{color:s},spacing:1,direction:"row",children:(0,o.jsx)(i.Z,{color:"inherit",size:t})})}},3808:function(e,n,t){"use strict";t.d(n,{Z:function(){return c}});var r=t(1413),i=t(2892),o=t(4666),a=t(3906),s=t(184);function c(e){var n=e.toolbarProps,t=e.children;return(0,s.jsx)(i.Z,(0,r.Z)((0,r.Z)({elevation:0},n),{},{children:(0,s.jsx)(o.Z,{variant:"regular",sx:{bgcolor:function(e){return"light"===e.palette.mode?a.s[100]:null},color:function(e){return"light"===e.palette.mode?"#000":null}},children:t})}))}},1582:function(e,n,t){"use strict";t.d(n,{$:function(){return l},k:function(){return c}});var r=t(4165),i=t(5861),o=t(4569),a=t.n(o),s=t(5316),c=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n){var t,i,o=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=o.length>1&&void 0!==o[1]?o[1]:0)){e.next=4;break}return e.next=4,(0,s._)(t);case 4:return e.prev=4,e.next=7,a().get(n,{headers:{"Content-Type":"application/json"},responseType:"json"});case 7:if(200!==(i=e.sent).status){e.next=10;break}return e.abrupt("return",i.data);case 10:return e.abrupt("return",Promise.reject(i));case 13:throw e.prev=13,e.t0=e.catch(4),console.error("App fetcher GET error:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(n){return e.apply(this,arguments)}}(),l=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(n,t){var i,o,c=arguments;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=c.length>2&&void 0!==c[2]?c[2]:0)){e.next=4;break}return e.next=4,(0,s._)(i);case 4:return e.prev=4,e.next=7,a().get(n,{headers:{"Content-Type":"application/json"},responseType:"json",signal:t.signal});case 7:if(200!==(o=e.sent).status){e.next=10;break}return e.abrupt("return",o.data);case 10:return e.abrupt("return",Promise.reject(o));case 13:throw e.prev=13,e.t0=e.catch(4),"ERR_CANCELED"!==e.t0.code&&console.error("App fetcher GET error:",e.t0),e.t0;case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(n,t){return e.apply(this,arguments)}}()},4596:function(e,n,t){"use strict";var r=t(2797),i=t(4142);n.Z=function(){var e=(0,i.Z)();return{isMobile:(0,r.Z)(e.breakpoints.down("sm")),isMed:(0,r.Z)(e.breakpoints.down("md")),isLg:(0,r.Z)(e.breakpoints.down("lg")),isXl:(0,r.Z)(e.breakpoints.down("xl"))}}},1372:function(e,n,t){"use strict";var r;t.d(n,{K:function(){return r}}),function(e){e.TABLE="table",e.CARD="card"}(r||(r={}))},2795:function(e,n,t){"use strict";t.d(n,{R3:function(){return a},e$:function(){return o}});var r=t(4569),i=t.n(r),o=function(e){var n=e.url,t=e.body,r=e.onSuccess,o=e.onFailure,a=e.onFinally;e.abortController;i().post(n,t).then((function(e){r&&r(e.data)})).catch((function(e){console.log("App error POST: ",e),o&&o(e)})).finally((function(){a&&a()}))},a=function(e){var n=e.url,t=e.body,r=e.onSuccess,o=e.onFailure,a=e.onFinally;e.abortController;i().put(n,t).then((function(e){r&&r(e.data)})).catch((function(e){console.log("App error PUT: ",e),o&&o(e)})).finally((function(){a&&a()}))}},5316:function(e,n,t){"use strict";function r(e){return new Promise((function(n,t){setTimeout((function(){n()}),e)}))}t.d(n,{_:function(){return r}})},7237:function(e,n,t){"use strict";var r=t(4836);n.Z=void 0;var i=r(t(5649)),o=t(184),a=(0,i.default)((0,o.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}),"Favorite");n.Z=a},6976:function(e,n,t){"use strict";var r=t(4836);n.Z=void 0;var i=r(t(5649)),o=t(184),a=(0,i.default)((0,o.jsx)("path",{d:"m18 22-.01-6L14 12l3.99-4.01L18 2H6v6l4 4-4 3.99V22h12zM8 7.5V4h8v3.5l-4 4-4-4z"}),"HourglassBottom");n.Z=a},4654:function(){}}]);
//# sourceMappingURL=341.ea9cff3d.chunk.js.map